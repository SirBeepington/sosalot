{
  "tools": {
    "query_sos_reports": {
      "description": "Query and list available SOS reports with their metadata.\n\nUse this tool FIRST to find available SOS reports. Each report has a report_id that you'll use with other tools. SOS reports contain Linux system diagnostic data.\n\nArgs:\n    hostname: Filter by hostname (partial match, case-insensitive)\n    serial_number: Filter by hardware serial number (exact match)\n    date_contains: Filter by creation date (partial match)\n\nReturns:\n    Dictionary with 'reports' list containing report metadata including:\n    - report_id: Simplified ID for use with other tools (e.g., \"centos9-original_20251209_1430\")\n    - report_name: Original directory name \n    - hostname: Extracted hostname from the report\n    - serial_number: Hardware serial number\n    - creation_date: When the report was created\n    \nExample: First call query_sos_reports() to get report_id, then use that with other tools like read_file(report=\"centos9-original_20251209_1430\", path=\"etc/hostname\")"
    },
    "list_dir": {
      "description": "List contents of a directory within a SOS report with pagination.\n\nArgs:\n    report: Report ID from query_sos_reports (e.g., \"centos9-original_20251209_1430\")\n    path: Path within the report (e.g., \"etc\", \"var/log\", \"proc\"). Use empty string for root.\n    offset: Skip this many matching items (default: 0)\n    limit: Return at most this many items (default: 50)\n    max_search: Stop searching after finding this many total matches (default: 500)\n    \nReturns:\n    Dictionary with:\n    - 'items': List of directory contents with type info  \n    - 'total_items': Total number of items found\n    - 'pagination': Pagination information\n    \nNote: Directories end with '/' in the name field.\n\nCommon useful paths:\n- \"etc\" - Configuration files (hostname, os-release, etc.)\n- \"var/log\" - Log files\n- \"sos_commands\" - Command outputs organized by category\n- \"proc\" - Process and system information"
    },
    "find_files_by_name": {
      "description": "Find files by name pattern within a single directory (non-recursive).\n\nSearches ONLY in the specified directory, NOT in subdirectories.\nPattern matching is CASE-INSENSITIVE and matches against FILENAME only (not full path).\nSupports pagination for large directories.\n\nArgs:\n    report: Report ID from query_sos_reports (e.g., \"centos9-original_20251209_1430\")\n    pattern: Glob pattern to match filenames (e.g., \"*swap*\", \"*.log\", \"*hostname*\", \"ip_*\")\n    search_path: Path within report to search (default: search report root directory)\n    offset: Skip this many matching items (for pagination, default 0)\n    limit: Return at most this many items (default 50, max 100)\n    max_search: Stop searching after finding this many total matches (default 500, max 2000)\n    \nReturns:\n    Dictionary with search results and pagination info\n    \nSearch Behavior:\n- NON-RECURSIVE: Searches only the specified directory\n- CASE-INSENSITIVE: \"Swap\" matches \"swap\", \"SWAP\", \"SwAp\"\n- FILENAME ONLY: Pattern matches against filename, not full path\n- PAGINATED: Use offset/limit to browse large directories\n\nCommon patterns:\n- \"*swap*\" - Find files containing \"swap\" in filename (case-insensitive)\n- \"*hostname*\" - Find hostname-related files\n- \"*.conf\" - Find configuration files  \n- \"ip_*\" - Find files starting with \"ip_\"\n\nExamples:\n- find_files_by_name(\"report1\", \"*.conf\", \"etc\", limit=20) \n  → First 20 .conf files in etc/ directory only\n- find_files_by_name(\"report1\", \"*SWAP*\", \"sos_commands/memory\")\n  → Find swapon, swapoff files in memory directory only\n\nSecurity: Globstar (**) patterns are not allowed."
    },
    "find_files_by_name_recursive": {
      "description": "Find files by name pattern recursively through all subdirectories.\n\nSearches RECURSIVELY through all subdirectories from the search_path.\nPattern matching is CASE-INSENSITIVE and matches against FILENAME only (not full path).\nSupports pagination for large result sets.\n\nArgs:\n    report: Report ID from query_sos_reports (e.g., \"centos9-original_20251209_1430\")\n    pattern: Glob pattern to match filenames (e.g., \"*swap*\", \"*.log\", \"*hostname*\", \"ip_*\")\n    search_path: Path within report to start search (default: search entire report recursively)\n    offset: Skip this many matching items (for pagination, default 0)\n    limit: Return at most this many items (default 50, max 100)\n    max_search: Stop searching after finding this many total matches (default 500, max 2000)\n    \nReturns:\n    Dictionary with search results and pagination info\n    \nSearch Behavior:\n- RECURSIVE: Searches all subdirectories under search_path\n- CASE-INSENSITIVE: \"Swap\" matches \"swap\", \"SWAP\", \"SwAp\"\n- FILENAME ONLY: Pattern matches against filename, not full path\n- PAGINATED: Use offset/limit to browse large result sets\n\nCommon patterns:\n- \"*swap*\" - Find files containing \"swap\" in filename (case-insensitive)\n- \"*hostname*\" - Find hostname-related files  \n- \"*.conf\" - Find configuration files everywhere\n- \"ip_*\" - Find files starting with \"ip_\"\n- \"*log*\" - Find files containing \"log\" in filename\n\nExamples:\n- find_files_by_name_recursive(\"report1\", \"*swap*\", \"sos_commands\") \n  → Finds sos_commands/memory/swapon_--summary_--verbose recursively\n- find_files_by_name_recursive(\"report1\", \"*.conf\", \"etc\", offset=0, limit=20)\n  → First 20 .conf files under etc/ and all subdirectories\n\nSecurity: Globstar (**) patterns are not allowed."
    },
    "read_file": {
      "description": "Read the contents of a file from a SOS report with pagination.\n\nArgs:\n    report: Report ID from query_sos_reports (e.g., \"centos9-original_20251209_1430\")\n    path: Path to file within report (e.g., \"etc/hostname\", \"var/log/messages\")\n    offset: Character offset to start reading (use 0 for beginning)\n    limit: Maximum characters to return\n\nReturns:\n    Dictionary with file content and pagination info\n    \nCommon useful files:\n- \"etc/hostname\" - System hostname\n- \"etc/os-release\" - OS version info\n- \"sos_commands/networking/ip_addr\" - IP addresses\n- \"sos_commands/networking/ip_route\" - Routing table\n- \"sos_commands/hardware/dmidecode\" - Hardware info\n- \"var/log/messages\" - System log messages"
    },
    "search_file": {
      "description": "Search for text within a specific file from a SOS report with character-based output limiting.\n\nArgs:\n    report: Report ID from query_sos_reports (e.g., \"centos9-original_20251209_1430\")\n    path: Path to file within report (e.g., \"sos_commands/networking/ip_addr\")\n    substring: Text to search for (case-insensitive)\n    lines_before: Context lines before each match (default: 0)\n    lines_after: Context lines after each match (default: 0)\n    offset: Character position to start output from (default: 0)\n    limit: Maximum characters to return (default: 10000)\n    max_matches: Maximum matches to return (default 50, max 200)\n\nReturns:\n    Dictionary with search results and character-based pagination info\n    \nTips:\n- Search for \"inet \" in networking files to find IP addresses\n- Search for \"ERROR\" or \"error\" in log files\n- Search for \"=\" in config files to find settings"
    },
    "get_info_sources_for_domain": {
      "description": "Get information source guidance for a specific domain in a SOS report.\n\nThis tool provides intelligent guidance on where to find specific types of information within SOS reports, returning only files that actually exist in the specified report.\n\nArgs:\n    domain: Information domain to get guidance for. Available domains are dynamically loaded from config.\n    report: SOS report ID to search within (e.g., \"centos9-original_20251209_2142\"). Use query_sos_reports() tool first to get available report IDs.\n\nReturns:\n    JSON string with structured guidance showing actual existing files for the specified domain in the given report. Only returns files that exist - no placeholders or missing file indicators."
    }
  }
}
